# 操作系统智慧乡村 - 使用指南

欢迎使用"操作系统智慧乡村"教育游戏平台！本指南将帮助您快速上手，通过有趣的游戏学习操作系统核心概念。

## 目录

- [快速开始](#快速开始)
- [系统要求](#系统要求)
- [安装步骤](#安装步骤)
- [游戏导航](#游戏导航)
- [六大游戏详解](#六大游戏详解)
- [AI功能使用](#ai功能使用)
- [学习报告](#学习报告)
- [常见问题](#常见问题)

---

## 快速开始

### 第一次使用

1. **启动项目**
   - 启动后端服务：`cd backend && python -m uvicorn app:app --reload`
   - 启动前端服务：`cd frontend && python -m http.server 3000`

2. **访问系统**
   - 在浏览器中打开：`http://localhost:3000`
   - 您将看到村庄广场主界面

3. **开始学习**
   - 点击任意建筑物进入对应游戏
   - 跟随"字节叔"的引导学习操作系统概念

---

## 系统要求

### 最低配置

| 组件 | 要求 |
|------|------|
| 操作系统 | Windows 10+, macOS 10.14+, Linux |
| 浏览器 | Chrome 90+, Firefox 88+, Safari 14+, Edge 90+ |
| 内存 | 4 GB RAM |
| 存储 | 500 MB 可用空间 |
| 网络 | 宽带网络连接（用于AI功能） |

### 推荐配置

| 组件 | 要求 |
|------|------|
| 浏览器 | Chrome 120+ (最佳体验) |
| 内存 | 8 GB RAM |
| 网络 | 稳定的网络连接 |

---

## 安装步骤

### 方式一：本地运行（推荐学习者）

#### 1. 克隆项目

```bash
git clone https://github.com/jfliu3265/os-smart-village.git
cd os-smart-village
```

#### 2. 安装后端依赖

```bash
cd backend

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

#### 3. 配置环境变量

```bash
# 复制环境变量模板
cp .env.example .env

# 编辑 .env 文件
# 至少需要配置 ZHIPUAI_API_KEY
```

#### 4. 初始化数据库

```bash
python database/init_db.py
```

#### 5. 启动后端服务

```bash
uvicorn app:app --reload --host 0.0.0.0 --port 8000
```

后端将运行在 http://localhost:8000

#### 6. 启动前端服务

打开新终端：

```bash
cd frontend
python -m http.server 3000
```

前端将运行在 http://localhost:3000

### 方式二：Docker 部署

```bash
# 构建并启动服务
docker-compose up -d

# 查看日志
docker-compose logs -f
```

---

## 游戏导航

### 村庄广场主界面

进入系统后，您将看到**村庄广场**，这是系统的导航中心：

```
┌────────────────────────────────────────┐
│     操作系统智慧乡村                    │
│     选择一个建筑物开始学习               │
│                                        │
│     👴 字节叔                           │
│     欢迎来到智慧乡村！                  │
│                                        │
│  ┌─────┐ ┌─────┐ ┌─────┐             │
│  │ 🌾  │ │ 🏠  │ │ 📁  │             │
│  │ 农田 │ │ 仓库 │ │ 档案 │             │
│  └─────┘ └─────┘ └─────┘             │
│                                        │
│  ┌─────┐ ┌─────┐ ┌─────┐             │
│  │ 🤝  │ │ ⚖️  │ │ 🚚  │             │
│  │ 协作 │ │ 争端 │ │ 运输 │             │
│  └─────┘ └─────┘ └─────┘             │
│                                        │
│              📊 学习报告                │
└────────────────────────────────────────┘
```

### 界面元素说明

- **建筑物卡片**：点击进入对应的学习游戏
- **字节叔**：您的AI导师，随时提供帮助和提示
- **学习报告**：查看您的学习进度和成绩

---

## 六大游戏详解

### 1. 🌾 农田作业调度 - 进程调度

**学习目标**：理解进程调度算法

**游戏玩法**：
1. 选择调度算法（FCFS/SJF/优先级/时间片轮转）
2. 观察进程（农田作业）的执行顺序
3. 查看统计数据（等待时间、周转时间）
4. 对比不同算法的性能差异

**乡村比喻**：
- 进程 = 农田作业（耕地、播种、施肥、收割）
- CPU = 农民
- 调度算法 = 作业安排方式

**操作步骤**：
```
1. 点击"农田作业调度"进入游戏
2. 在右侧面板选择调度算法
3. 点击"开始调度"观看模拟
4. 观察执行时间线和统计数据
5. 切换不同算法进行对比
```

**学习要点**：
- FCFS（先来先服务）：简单但效率低
- SJF（短作业优先）：平均等待时间最短
- 优先级调度：灵活但可能导致饥饿
- RR（时间片轮转）：公平，适合分时系统

---

### 2. 🏠 仓库粮食管理 - 内存管理

**学习目标**：掌握内存管理技术

**游戏玩法**：
1. 学习内存分配策略
2. 观察分页和分段机制
3. 理解虚拟内存的工作原理
4. 处理内存碎片问题

**乡村比喻**：
- 内存 = 粮仓空间
- 进程 = 粮食作物
- 分页 = 货架划分
- 虚拟内存 = 临时借用的仓库

**操作步骤**：
```
1. 点击"仓库粮食管理"进入游戏
2. 选择内存分配策略
3. 模拟进程的内存申请和释放
4. 观察内存使用情况和碎片产生
5. 学习内存优化的方法
```

**学习要点**：
- 连续分配 vs 非连续分配
- 分页管理：固定大小的页
- 分段管理：按逻辑划分
- 虚拟内存：扩展可用内存

---

### 3. 📁 村庄档案室 - 文件系统

**学习目标**：理解文件系统的组织结构

**游戏玩法**：
1. 创建、删除、移动文件和目录
2. 理解目录树的结构
3. 学习文件的存储方式
4. 掌握inode的概念

**乡村比喻**：
- 文件 = 档案文件
- 目录 = 档案柜
- 路径 = 档案位置
- inode = 档案编号

**操作步骤**：
```
1. 点击"村庄档案室"进入游戏
2. 执行文件操作（创建/删除/移动）
3. 观察目录树的变化
4. 查看文件的inode信息
5. 理解不同文件系统的特点
```

**学习要点**：
- 文件 vs 目录
- 绝对路径 vs 相对路径
- 树形结构
- inode和文件类型

---

### 4. 🤝 村民协作 - 进程同步

**学习目标**：掌握进程同步机制

**游戏玩法**：
1. 模拟多个进程（村民）协作完成任务
2. 学习信号量和互斥锁的使用
3. 处理竞争条件
4. 实现进程间通信

**乡村比喻**：
- 进程 = 村民
- 共享资源 = 公共工具（水井、农具）
- 互斥锁 = 工具借用证
- 信号量 = 可用工具数量

**操作步骤**：
```
1. 点击"村民协作"进入游戏
2. 设置协作任务
3. 使用同步机制协调进程
4. 观察同步和异步的区别
5. 处理死锁问题
```

**学习要点**：
- 竞争条件（Race Condition）
- 互斥锁（Mutex）
- 信号量（Semaphore）
- 管程（Monitor）

---

### 5. ⚖️ 资源争端调解 - 死锁处理

**学习目标**：理解死锁产生的原因和解决方法

**游戏玩法**：
1. 模拟资源分配场景
2. 检测死锁的发生
3. 学习死锁预防和避免策略
4. 实践死锁恢复方法

**乡村比喻**：
- 死锁 = 村民互相等待资源，无法继续
- 资源分配图 = 谁持有谁等待的关系图
- 死锁预防 = 制定规则避免死锁
- 死锁恢复 = 强行解除等待

**操作步骤**：
```
1. 点击"资源争端调解"进入游戏
2. 观察资源分配和等待情况
3. 点击"检测死锁"分析是否存在死锁
4. 使用"解除死锁"功能恢复系统
5. 学习不同的死锁处理策略
```

**学习要点**：
- 死锁的四个必要条件
- 死锁预防：破坏四个条件之一
- 死锁避免：银行家算法
- 死锁检测：资源分配图
- 死锁恢复：抢占或终止

---

### 6. 🚚 物资运输队 - I/O管理

**学习目标**：掌握I/O系统的控制方式

**游戏玩法**：
1. 模拟I/O设备的数据传输
2. 对比不同I/O控制方式
3. 理解中断机制
4. 学习DMA和通道技术

**乡村比喻**：
- CPU = 村长
- I/O设备 = 运输队
- 数据 = 物资
- 中断 = 运输完成通知
- DMA = 专业运输队

**操作步骤**：
```
1. 点击"物资运输队"进入游戏
2. 发起I/O请求
3. 选择I/O控制方式（轮询/中断/DMA/通道）
4. 观察CPU利用率变化
5. 理解不同方式的适用场景
```

**学习要点**：
- 轮询方式：CPU忙等待
- 中断方式：设备主动通知
- DMA方式：直接内存访问
- 通道方式：独立的I/O处理器
- Spooling技术：假脱机

---

## AI功能使用

### 字节叔 - 您的智能导师

字节叔是集成了智谱AI的虚拟角色，能够为您提供：

#### 1. 智能提示 💡

当您在游戏中遇到困难时：

```
1. 点击"获取提示"按钮
2. 字节叔会根据您的当前状态给出针对性提示
3. 提示使用乡村比喻，通俗易懂
```

#### 2. 个性化反馈 📊

完成游戏后：

```
1. 系统自动分析您的表现
2. 字节叔给出鼓励和建议
3. 推荐需要复习的知识点
4. 指出下一步学习方向
```

#### 3. AI问答 ❓

随时向字节叔提问：

```
1. 在游戏中找到提问入口
2. 输入您的问题
3. 字节叔用乡村比喻解答
4. 帮助您理解抽象概念
```

**示例问题**：
- "为什么时间片轮转更公平？"
- "什么是虚拟内存？"
- "死锁怎么预防？"

#### 4. 动态练习题 📝

字节叔可以为您生成练习题：

```
1. 选择您想练习的主题
2. AI根据您水平出题
3. 即时反馈答案解析
4. 巩固学习效果
```

---

## 学习报告

### 查看学习报告

在村庄广场点击"📊 学习报告"按钮，查看您的学习数据：

#### 报告内容

1. **总体进度**
   - 完成的游戏数量
   - 总体学习进度百分比
   - 学习时间统计

2. **游戏成绩**
   - 每个游戏的得分
   - 获得的星星数量
   - 完成次数

3. **AI学习建议**
   - 基于您的表现生成的建议
   - 需要复习的知识点
   - 下一步学习路径

4. **数据导出**
   - 导出为PDF报告
   - 导出为JSON/CSV数据
   - 分享学习成果

---

## 常见问题

### Q1: 游戏无法启动？

**可能原因**：
- 后端服务未启动
- 浏览器不兼容
- 端口被占用

**解决方法**：
```bash
# 检查后端是否运行
curl http://localhost:8000/health

# 更换端口
python -m http.server 3001
```

### Q2: AI功能无法使用？

**可能原因**：
- 未配置智谱AI API Key
- 网络连接问题
- API额度用完

**解决方法**：
```bash
# 检查环境变量
cat backend/.env

# 确保有 ZHIPUAI_API_KEY
# 在智谱AI官网获取：https://open.bigmodel.cn/
```

### Q3: 数据库初始化失败？

**解决方法**：
```bash
# 手动创建数据库目录
mkdir -p backend/database

# 重新初始化
cd backend
python database/init_db.py
```

### Q4: 游戏画面显示异常？

**可能原因**：
- 浏览器版本过低
- JavaScript被禁用
- 屏幕分辨率不足

**解决方法**：
- 更新浏览器到最新版
- 启用JavaScript
- 使用1920x1080或更高分辨率

### Q5: 如何重置学习进度？

**方法一**：清除浏览器缓存
```
浏览器设置 → 隐私和安全 → 清除浏览数据
```

**方法二**：删除数据库
```bash
rm backend/database/os_village.db
python database/init_db.py
```

### Q6: 可以离线使用吗？

**可以**，但有以下限制：
- ✅ 所有游戏功能完全可用
- ❌ AI功能需要网络连接
- ❌ 学习报告需要后端服务

---

## 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| ESC | 返回村庄广场 |
| H | 获取提示 |
| R | 重置当前关卡 |
| SPACE | 暂停/继续 |

---

## 教师使用指南

### 课堂演示

1. **投影模式**
   - 建议使用1920x1080分辨率
   - 全屏显示获得最佳效果

2. **互动教学**
   - 让学生选择调度算法
   - 实时演示执行过程
   - 对比不同算法性能

3. **作业布置**
   - 每个游戏完成后截图
   - 导出学习报告提交
   - 记录AI给出的建议

### 学习进度追踪

查看全班学生的学习数据：

```bash
# 导出所有学生数据
curl http://localhost:8000/api/report/export
```

---

## 技术支持

如遇到问题：

1. 查看 [部署文档](DEPLOYMENT.md)
2. 检查 [GitHub Issues](https://github.com/jfliu3265/os-smart-village/issues)
3. 提交新的Issue并提供详细信息

---

## 更新日志

### v1.0.0 (2025-01-06)
- ✅ 六大游戏全部完成
- ✅ AI智能导师集成
- ✅ 学习报告系统
- ✅ 完整的文档

---

**祝您学习愉快！** 🎮✨

*让操作系统学习变得有趣而简单！*
